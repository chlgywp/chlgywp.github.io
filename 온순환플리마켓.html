<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ëŒ€ê±´ì˜¨ìˆœí™˜ | ìš°ë¦¬ í•™êµ ì¥í„°</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css" rel="stylesheet">
    
    <style>
        /* [ë””ìì¸ ì‹œìŠ¤í…œ: Modern & Sleek] */
        :root {
            --primary: #2563eb; /* ì‹ ë¢°ê°ì„ ì£¼ëŠ” ë¡œì–„ ë¸”ë£¨ */
            --dark: #111827;    /* ê±°ì˜ ê²€ì •ì— ê°€ê¹Œìš´ ì§„í•œ ë‚¨ìƒ‰ */
            --gray: #6b7280;    /* ì„¸ë ¨ëœ íšŒìƒ‰ */
            --light: #f3f4f6;   /* ì•„ì£¼ ì—°í•œ íšŒìƒ‰ ë°°ê²½ */
            --white: #ffffff;
            --border: #e5e7eb;  /* ì–‡ê³  ì„¬ì„¸í•œ í…Œë‘ë¦¬ */
            --danger: #ef4444;  /* ê²½ê³  ë ˆë“œ */
        }

        * { box-sizing: border-box; margin: 0; padding: 0; outline: none; -webkit-tap-highlight-color: transparent; }
        body { 
            font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, system-ui, sans-serif;
            background-color: var(--white); 
            color: var(--dark); 
            padding-top: 60px; /* í—¤ë” ë†’ì´ë§Œí¼ ì—¬ë°± */
            min-height: 100vh; /* í™”ë©´ ì „ì²´ ë†’ì´ ì‚¬ìš© */
            display: flex;
            flex-direction: column; /* ë‚´ìš©ì„ ì„¸ë¡œë¡œ ë°°ì¹˜ */
        }

        /* ê³µí†µ ë²„íŠ¼ ìŠ¤íƒ€ì¼ (ë¯¸ë‹ˆë©€) */
        button { cursor: pointer; border: none; background: none; font-family: inherit; }
        
        .btn { 
            display: inline-flex; justify-content: center; align-items: center;
            padding: 14px; border-radius: 8px; font-weight: 600; font-size: 0.95rem; 
            transition: all 0.2s ease; width: 100%;
        }
        .btn:active { transform: scale(0.98); }

        .btn-primary { background: var(--dark); color: white; }
        .btn-primary:hover { background: black; }

        .btn-accent { background: var(--primary); color: white; }
        .btn-accent:hover { background: #1d4ed8; }
        
        .btn-outline { border: 1px solid var(--border); color: var(--dark); background: white; }
        .btn-outline:hover { background: var(--light); border-color: #d1d5db; }

        .btn-kakao { background: #fee500; color: #191919; font-weight: 500; }
        
        /* ê´€ë¦¬ì ì‚­ì œ ë²„íŠ¼ (ì‹¬í”Œí•˜ê²Œ) */
        .btn-delete { 
            margin-top: 8px; padding: 8px; font-size: 0.8rem; 
            color: var(--gray); text-decoration: underline; background: transparent; 
        }
        .btn-delete:hover { color: var(--danger); }

        /* í—¤ë” (ë¸”ëŸ¬ íš¨ê³¼ ì ìš©) */
        header { 
            position: fixed; top: 0; left: 0; width: 100%; height: 65px; /* í—¤ë” ë†’ì´ ì•½ê°„ ì¦ê°€ */
            background: rgba(255, 255, 255, 0.9); backdrop-filter: blur(10px);
            border-bottom: 1px solid var(--border);
            display: flex; justify-content: space-between; align-items: center; 
            padding: 0 5%; z-index: 1000;
        }
        .logo { 
            /* â­ ìˆ˜ì •ë¨: ë¡œê³  í¬ê¸° í™•ëŒ€ (1.2rem -> 1.5rem) */
            font-size: 1.5rem; font-weight: 800; color: var(--dark); letter-spacing: -0.5px; cursor: pointer;
            display: flex; align-items: center; gap: 8px;
        }
        .logo i { color: var(--primary); font-size: 1.2rem; }

        /* ë„¤ë¹„ê²Œì´ì…˜ íƒ­ (ë°‘ì¤„í˜•) */
        .nav-group { display: flex; gap: 20px; height: 100%; }
        .nav-item { 
            display: flex; align-items: center; height: 100%; 
            font-weight: 600; color: var(--gray); cursor: pointer; position: relative;
            font-size: 0.95rem;
        }
        .nav-item:hover { color: var(--dark); }
        .nav-item.active { color: var(--dark); }
        .nav-item.active::after {
            content: ''; position: absolute; bottom: 0; left: 0; width: 100%; height: 2px;
            background: var(--dark);
        }
        /* ê¸°ë¶€ íƒ­ í™œì„±í™” ì‹œ í¬ì¸íŠ¸ ì»¬ëŸ¬ ë³€ê²½ */
        .nav-item.active-donate { color: var(--primary); }
        .nav-item.active-donate::after { background: var(--primary); }

        /* ë©”ì¸ ë ˆì´ì•„ì›ƒ */
        .container { 
            max-width: 1200px; margin: 0 auto; padding: 30px 20px; 
            animation: fadeIn 0.4s ease-out; display: none; 
            flex-grow: 1; /* ë‚¨ì€ ê³µê°„ì„ ì±„ìš°ë„ë¡ ì„¤ì • (í‘¸í„°ë¥¼ í•˜ë‹¨ìœ¼ë¡œ ë°€ì–´ëƒ„) */
            width: 100%;
        }
        .container.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* í•„í„° (í† ê¸€ ìŠ¤íƒ€ì¼) */
        .filter-wrapper { display: flex; gap: 8px; overflow-x: auto; padding-bottom: 10px; margin-bottom: 20px; scrollbar-width: none; }
        .filter-wrapper::-webkit-scrollbar { display: none; }
        
        .filter-chip { 
            padding: 8px 16px; border-radius: 50px; border: 1px solid var(--border); 
            background: white; color: var(--gray); font-size: 0.9rem; font-weight: 500; cursor: pointer; white-space: nowrap; transition: 0.2s;
        }
        .filter-chip:hover { border-color: var(--gray); color: var(--dark); }
        .filter-chip.selected { background: var(--dark); color: white; border-color: var(--dark); }

        /* ê·¸ë¦¬ë“œ ì¹´ë“œ ì‹œìŠ¤í…œ */
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(260px, 1fr)); gap: 30px; }

        /* ì¹´ë“œ ë””ìì¸ (ë¯¸ë‹ˆë©€ë¦¬ì¦˜) */
        .card { 
            background: white; border-radius: 0; /* ê°ì§€ê²Œ */
            overflow: hidden; transition: 0.3s ease; 
            display: flex; flex-direction: column;
            border-bottom: 1px solid transparent;
        }
        .card:hover { transform: translateY(-4px); }

        .card-img-box { 
            width: 100%; aspect-ratio: 1 / 1; background: var(--light); 
            position: relative; overflow: hidden; border-radius: 8px;
        }
        .card-img { width: 100%; height: 100%; object-fit: cover; transition: 0.4s; }
        .card:hover .card-img { transform: scale(1.05); }

        .card-status { 
            position: absolute; top: 0; left: 0; width: 100%; height: 100%; 
            background: rgba(0,0,0,0.6); color: white; 
            display: flex; justify-content: center; align-items: center; 
            font-weight: 700; font-size: 1.1rem; backdrop-filter: blur(2px);
        }

        .card-info { padding: 16px 0; display: flex; flex-direction: column; flex-grow: 1; }
        
        .card-tag { 
            font-size: 0.75rem; font-weight: 700; color: var(--primary); 
            text-transform: uppercase; margin-bottom: 6px; letter-spacing: 0.5px;
        }
        .card-title { font-size: 1rem; font-weight: 600; color: var(--dark); margin-bottom: 6px; line-height: 1.4; }
        .card-price { font-size: 1.1rem; font-weight: 800; color: var(--dark); }
        .card-seller { font-size: 0.85rem; color: #9ca3af; margin-top: auto; padding-top: 10px; }

        .card-actions { margin-top: 12px; display: flex; flex-direction: column; gap: 8px; }

        /* ë¡œê·¸ì¸ í™”ë©´ (ì„¼í„° ì •ë ¬, ì‹¬í”Œ) */
        #login-screen { 
            position: fixed; top: 0; left: 0; width: 100%; height: 100vh; 
            background: white; z-index: 2000; 
            display: flex; flex-direction: column; justify-content: center; align-items: center; 
            padding: 20px;
        }
        .login-inner { width: 100%; max-width: 360px; text-align: center; }
        .input-field { 
            width: 100%; padding: 16px; margin: 24px 0; 
            border: 1px solid var(--border); border-radius: 8px; 
            font-size: 1rem; background: var(--light); transition: 0.2s;
        }
        .input-field:focus { border-color: var(--dark); background: white; }

        /* ê¸€ì“°ê¸° ëª¨ë‹¬ */
        .write-wrap { max-width: 500px; margin: 0 auto; background: white; }
        .form-label { display: block; font-size: 0.9rem; font-weight: 700; margin-bottom: 8px; color: var(--dark); }
        .file-upload { 
            border: 1px dashed #d1d5db; padding: 40px; text-align: center; 
            border-radius: 8px; cursor: pointer; transition: 0.2s; color: var(--gray);
        }
        .file-upload:hover { border-color: var(--dark); color: var(--dark); background: var(--light); }

        /* í”Œë¡œíŒ… ë²„íŠ¼ (ì„¸ë ¨ëœ ì›í˜•) */
        .fab { 
            position: fixed; bottom: 40px; right: 40px; 
            width: 60px; height: 60px; border-radius: 50%; 
            background: var(--dark); color: white; 
            display: flex; justify-content: center; align-items: center; 
            font-size: 1.5rem; box-shadow: 0 10px 25px rgba(0,0,0,0.2); 
            cursor: pointer; z-index: 900; transition: transform 0.2s;
        }
        .fab:hover { transform: scale(1.1) rotate(90deg); }
        .fab.mode-donate { background: var(--primary); box-shadow: 0 10px 25px rgba(37, 99, 235, 0.4); }

        /* ê²€ìƒ‰ì°½ */
        .search-bar { width: 100%; padding: 14px; border: 1px solid var(--border); border-radius: 8px; margin-bottom: 24px; font-size: 1rem; }
        
        /* ì•ˆë‚´ ë°•ìŠ¤ */
        .info-box { 
            background: var(--light); padding: 24px; border-radius: 12px; 
            margin-bottom: 30px; text-align: center; 
        }
        .info-box h3 { font-size: 1.1rem; margin-bottom: 8px; }
        .info-box p { font-size: 0.9rem; color: var(--gray); }

        /* â­ ì¶”ê°€ëœ í‘¸í„° ìŠ¤íƒ€ì¼ */
        .dev-footer {
            text-align: center;
            padding: 25px 0;
            margin-top: auto; /* ë‚´ìš©ì´ ì§§ì•„ë„ í•­ìƒ ë§¨ ì•„ë˜ì— ìœ„ì¹˜ */
            font-size: 0.85rem;
            color: var(--gray);
            background: var(--white);
            border-top: 1px solid var(--border);
        }

    </style>
</head>
<body>

    <div id="login-screen">
        <div class="login-inner">
            <h1 style="font-size: 2.5rem; font-weight: 800; letter-spacing: -1px; margin-bottom: 15px; color:var(--primary);">ëŒ€ê±´ì˜¨ìˆœí™˜</h1>
            <p style="color: var(--gray); font-size: 1rem;">ìš°ë¦¬ í•™êµ ì¤‘ê³ ê±°ë˜ & ë‚˜ëˆ” í”Œë«í¼</p>
            
            <input type="text" id="my-id" class="input-field" placeholder="ë‹‰ë„¤ì„ ì…ë ¥">
            
            <button class="btn btn-primary" onclick="window.app.login()">ì‹œì‘í•˜ê¸°</button>
        </div>
    </div>

    <header id="header" style="display:none;">
        <div class="logo" onclick="window.app.goHome()">
            <i class="fas fa-circle-nodes"></i> ëŒ€ê±´ì˜¨ìˆœí™˜
        </div>
        <div class="nav-group">
            <div id="tab-trade" class="nav-item active" onclick="window.app.switchTab('trade')">ì¤‘ê³ ì¥í„°</div>
            <div id="tab-donate" class="nav-item" onclick="window.app.switchTab('donate')">ê¸°ë¶€Â·ë‚˜ëˆ”</div>
        </div>
        <button class="btn btn-outline" style="width: auto; padding: 8px 16px; font-size: 0.8rem;" onclick="location.reload()">ë¡œê·¸ì•„ì›ƒ</button>
    </header>

    <div id="screen-home" class="container">
        <div class="filter-wrapper">
            <span class="filter-chip selected" onclick="window.app.filter(this, 'all')">ì „ì²´</span>
            <span class="filter-chip" onclick="window.app.filter(this, 'book')">ë„ì„œ/ë¬¸ì œì§‘</span>
            <span class="filter-chip" onclick="window.app.filter(this, 'tech')">ì „ìê¸°ê¸°</span>
            <span class="filter-chip" onclick="window.app.filter(this, 'life')">ìƒí™œìš©í’ˆ</span>
            <span class="filter-chip" onclick="window.app.filter(this, 'etc')">ê¸°íƒ€</span>
        </div>
        
        <input type="text" id="search" class="search-bar" placeholder="ì°¾ìœ¼ì‹œëŠ” ë¬¼ê±´ì´ ìˆë‚˜ìš”?" onkeyup="window.app.renderTrade()">
        
        <div id="trade-list" class="grid"></div>
        <div class="fab" onclick="window.app.goWrite('trade')"><i class="fas fa-plus"></i></div>
    </div>

    <div id="screen-donate-home" class="container">
        <div class="info-box">
            <h3 style="color: var(--primary);">ê¸°ë¶€ ì²œì‚¬ê°€ ë˜ì–´ì£¼ì„¸ìš”</h3>
            <p>ë” ì´ìƒ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ë¬¼ê±´ìœ¼ë¡œ ë”°ëœ»í•œ ë§ˆìŒì„ ë‚˜ëˆ„ì„¸ìš”.</p>
        </div>
        <div id="donate-list" class="grid"></div>
        <div class="fab mode-donate" onclick="window.app.goWrite('donate')"><i class="fas fa-gift"></i></div>
    </div>

    <div id="screen-write" class="container">
        <div class="write-wrap">
            <h2 id="write-title" style="margin-bottom: 30px; font-weight: 800;">ë¬¼ê±´ ë“±ë¡</h2>
            
            <div style="margin-bottom: 24px;">
                <label class="form-label">ìƒí’ˆ ì‚¬ì§„</label>
                <div class="file-upload" onclick="document.getElementById('w-file').click()">
                    <i class="fas fa-camera" style="font-size: 1.5rem; margin-bottom: 10px;"></i><br>
                    <span>í´ë¦­í•˜ì—¬ ì‚¬ì§„ ì—…ë¡œë“œ</span>
                </div>
                <input type="file" id="w-file" accept="image/*" style="display:none;" onchange="window.app.preview(this)">
                <img id="w-img-preview" style="width:100%; margin-top:16px; border-radius:8px; display:none;">
            </div>

            <div style="margin-bottom: 24px;">
                <label class="form-label">ì œëª©</label>
                <input type="text" id="w-title" class="input-field" style="margin:0;" placeholder="ë¬¼ê±´ ì´ë¦„">
            </div>

            <div style="margin-bottom: 24px;" id="price-group">
                <label class="form-label">ê°€ê²©</label>
                <input type="number" id="w-price" class="input-field" style="margin:0;" placeholder="íŒë§¤ ê°€ê²© (ì›)">
            </div>

            <div style="margin-bottom: 24px;">
                <label class="form-label">ì¹´í…Œê³ ë¦¬</label>
                <select id="w-cat" class="input-field" style="margin:0;">
                    <option value="book">ë„ì„œ/ë¬¸ì œì§‘</option>
                    <option value="tech">ì „ìê¸°ê¸°</option>
                    <option value="life">ìƒí™œìš©í’ˆ</option>
                    <option value="etc">ê¸°íƒ€</option>
                </select>
            </div>

            <div style="margin-bottom: 40px;">
                <label class="form-label">ì¹´ì¹´ì˜¤í†¡ ë§í¬</label>
                <input type="text" id="w-link" class="input-field" style="margin:0;" placeholder="ì˜¤í”ˆì±„íŒ…ë°© ì£¼ì†Œ ë¶™ì—¬ë„£ê¸°">
            </div>

            <div style="display:flex; gap:12px;">
                <button class="btn btn-outline" onclick="window.app.goBack()">ì·¨ì†Œ</button>
                <button class="btn btn-primary" id="btn-submit" onclick="window.app.upload()">ë“±ë¡ ì™„ë£Œ</button>
            </div>
        </div>
    </div>

    <footer class="dev-footer">
        ê°œë°œì choihyoje
    </footer>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getDatabase, ref, set, onValue, update, remove } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

        // ğŸ”´ ë³¸ì¸ì˜ Firebase í‚¤ ê°’ìœ¼ë¡œ êµì²´í•´ì£¼ì„¸ìš”! ğŸ”´
        const firebaseConfig = {
            apiKey: "ë³¸ì¸ì˜_apiKey_ì…ë ¥",
            authDomain: "ë³¸ì¸ì˜_authDomain_ì…ë ¥",
            databaseURL: "https://onsunhwan-default-rtdb.firebaseio.com",
            projectId: "ë³¸ì¸ì˜_projectId_ì…ë ¥",
            storageBucket: "ë³¸ì¸ì˜_storageBucket_ì…ë ¥",
            messagingSenderId: "ë³¸ì¸ì˜_ID_ì…ë ¥",
            appId: "ë³¸ì¸ì˜_AppID_ì…ë ¥"
        };

        const fbApp = initializeApp(firebaseConfig);
        const db = getDatabase(fbApp);
        
        // ğŸ¤« ê´€ë¦¬ì ID (Secret)
        const ADMIN_ID = 'chlgywp1820';

        window.app = {
            user: null,
            products: [],
            currentTab: 'trade',
            currentCat: 'all',
            writeMode: 'trade',

            init: function() {
                const productsRef = ref(db, 'products');
                onValue(productsRef, (snapshot) => {
                    const data = snapshot.val();
                    this.products = data ? Object.values(data) : [];
                    this.refresh();
                });
            },

            login: function() {
                const id = document.getElementById('my-id').value.trim();
                if(!id) return alert('ë‹‰ë„¤ì„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                this.user = id;
                document.getElementById('login-screen').style.display = 'none';
                document.getElementById('header').style.display = 'flex';
                
                if(this.user === ADMIN_ID) alert('ê´€ë¦¬ì ê³„ì •ìœ¼ë¡œ ì ‘ì†í–ˆìŠµë‹ˆë‹¤.');
                
                this.switchTab('trade');
            },

            switchTab: function(tabName) {
                this.currentTab = tabName;
                document.querySelectorAll('.container').forEach(s => s.classList.remove('active'));
                document.querySelectorAll('.nav-item').forEach(n => {
                    n.classList.remove('active');
                    n.classList.remove('active-donate');
                });

                if(tabName === 'trade') {
                    document.getElementById('screen-home').classList.add('active');
                    document.getElementById('tab-trade').classList.add('active');
                } else {
                    document.getElementById('screen-donate-home').classList.add('active');
                    document.getElementById('tab-donate').classList.add('active-donate');
                }
                this.refresh();
            },

            goHome: function() { this.switchTab('trade'); },
            goBack: function() { this.switchTab(this.currentTab); },

            goWrite: function(mode) {
                document.querySelectorAll('.container').forEach(s => s.classList.remove('active'));
                document.getElementById('screen-write').classList.add('active');
                
                document.getElementById('w-title').value = '';
                document.getElementById('w-price').value = '';
                document.getElementById('w-link').value = '';
                document.getElementById('w-file').value = '';
                document.getElementById('w-img-preview').style.display = 'none';
                
                const title = document.getElementById('write-title');
                const priceGroup = document.getElementById('price-group');
                const btn = document.getElementById('btn-submit');

                this.writeMode = mode;

                if(mode === 'donate') {
                    title.innerText = 'ë¬´ë£Œë‚˜ëˆ” ë“±ë¡';
                    priceGroup.style.display = 'none';
                    btn.className = 'btn btn-accent';
                    btn.innerText = 'ë‚˜ëˆ”í•˜ê¸°';
                } else {
                    title.innerText = 'ì¤‘ê³ ë¬¼í’ˆ ë“±ë¡';
                    priceGroup.style.display = 'block';
                    btn.className = 'btn btn-primary';
                    btn.innerText = 'ë“±ë¡í•˜ê¸°';
                }
            },

            preview: function(input) {
                if(input.files && input.files[0]) {
                    const file = input.files[0];
                    if(file.size > 1024 * 1024) return alert("ì‚¬ì§„ ìš©ëŸ‰ì´ ë„ˆë¬´ í½ë‹ˆë‹¤ (1MB ì´í•˜)");
                    const reader = new FileReader();
                    reader.onload = e => {
                        const img = document.getElementById('w-img-preview');
                        img.src = e.target.result;
                        img.style.display = 'block';
                    }
                    reader.readAsDataURL(file);
                }
            },

            upload: function() {
                const title = document.getElementById('w-title').value;
                const link = document.getElementById('w-link').value;
                const cat = document.getElementById('w-cat').value;
                const imgTag = document.getElementById('w-img-preview');
                const img = (imgTag.style.display === 'block') ? imgTag.src : null;
                
                let price = 0;
                if(this.writeMode === 'trade') {
                    price = document.getElementById('w-price').value;
                    if(!price) return alert('ê°€ê²©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                }

                if(!title) return alert('ì œëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                if(!img) return alert('ì‚¬ì§„ì€ í•„ìˆ˜ì…ë‹ˆë‹¤.');

                const id = Date.now();
                set(ref(db, 'products/' + id), {
                    id: id, title: title, price: price, cat: cat, link: link,
                    img: img, seller: this.user, type: this.writeMode, status: 'active'
                }).then(() => {
                    alert('ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤!');
                    this.switchTab(this.writeMode);
                });
            },

            markSold: function(id) {
                if(confirm('ê±°ë˜(ë‚˜ëˆ”) ì™„ë£Œ ì²˜ë¦¬í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                    update(ref(db, 'products/' + id), { status: 'sold' });
                }
            },

            deleteItem: function(id) {
                if(confirm('ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\nì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.')) {
                    remove(ref(db, 'products/' + id));
                }
            },

            filter: function(el, cat) {
                document.querySelectorAll('.filter-chip').forEach(c => c.classList.remove('selected'));
                el.classList.add('selected');
                this.currentCat = cat;
                this.refresh();
            },

            refresh: function() {
                if(this.currentTab === 'trade') this.renderTrade();
                else this.renderDonate();
            },

            renderTrade: function() {
                const list = document.getElementById('trade-list');
                const keyword = document.getElementById('search').value.toLowerCase();
                list.innerHTML = '';

                let result = this.products.filter(p => p.type === 'trade').sort((a,b) => b.id - a.id);
                if(keyword) result = result.filter(p => p.title.toLowerCase().includes(keyword));
                if(this.currentCat !== 'all') result = result.filter(p => p.cat === this.currentCat);

                result.forEach(p => {
                    const isSold = p.status === 'sold';
                    const isMyItem = p.seller === this.user;
                    const isAdmin = this.user === ADMIN_ID;

                    let btnHtml = '';
                    if(isSold) btnHtml = `<button class="btn" style="background:#e5e7eb; color:#9ca3af; cursor:not-allowed;">ê±°ë˜ì™„ë£Œ</button>`;
                    else if(isMyItem) btnHtml = `<button class="btn btn-primary" onclick="window.app.markSold(${p.id})">íŒë§¤ì™„ë£Œ ì²˜ë¦¬</button>`;
                    else if(p.link) btnHtml = `<button class="btn btn-kakao" onclick="window.open('${p.link}')"><i class="fas fa-comment"></i> ì±„íŒ…í•˜ê¸°</button>`;
                    else btnHtml = `<button class="btn btn-outline" disabled>ë§í¬ ì—†ìŒ</button>`;

                    let deleteBtn = '';
                    if(isMyItem || isAdmin) {
                        deleteBtn = `<button class="btn-delete" onclick="window.app.deleteItem(${p.id})">ê²Œì‹œë¬¼ ì‚­ì œ</button>`;
                    }

                    list.innerHTML += `
                        <div class="card">
                            <div class="card-img-box">
                                <img src="${p.img}" class="card-img">
                                ${isSold ? '<div class="card-status">ê±°ë˜ì™„ë£Œ</div>' : ''}
                            </div>
                            <div class="card-info">
                                <div class="card-tag">${p.cat === 'book' ? 'ë„ì„œ' : p.cat === 'tech' ? 'ê¸°ê¸°' : p.cat === 'life' ? 'ìƒí™œ' : 'ê¸°íƒ€'}</div>
                                <div class="card-title">${p.title}</div>
                                <div class="card-price">${Number(p.price).toLocaleString()}ì›</div>
                                <div class="card-seller">íŒë§¤ì: ${p.seller}</div>
                                <div class="card-actions">
                                    ${btnHtml}
                                    ${deleteBtn}
                                </div>
                            </div>
                        </div>`;
                });
            },

            renderDonate: function() {
                const list = document.getElementById('donate-list');
                list.innerHTML = '';
                let result = this.products.filter(p => p.type === 'donate').sort((a,b) => b.id - a.id);

                if(result.length === 0) {
                    list.innerHTML = `<div style="grid-column:1/-1; text-align:center; padding:60px 0; color:#9ca3af;">ë“±ë¡ëœ ë‚˜ëˆ” ë¬¼í’ˆì´ ì—†ìŠµë‹ˆë‹¤.</div>`;
                    return;
                }

                result.forEach(p => {
                    const isSold = p.status === 'sold';
                    const isMyItem = p.seller === this.user;
                    const isAdmin = this.user === ADMIN_ID;

                    let btnHtml = '';
                    if(isSold) btnHtml = `<button class="btn" style="background:#e5e7eb; color:#9ca3af; cursor:not-allowed;">ë‚˜ëˆ”ì™„ë£Œ</button>`;
                    else if(isMyItem) btnHtml = `<button class="btn btn-accent" onclick="window.app.markSold(${p.id})">ë‚˜ëˆ”ì™„ë£Œ ì²˜ë¦¬</button>`;
                    else if(p.link) btnHtml = `<button class="btn btn-kakao" onclick="window.open('${p.link}')">ì±„íŒ…í•˜ê¸°</button>`;

                    let deleteBtn = '';
                    if(isMyItem || isAdmin) {
                        deleteBtn = `<button class="btn-delete" onclick="window.app.deleteItem(${p.id})">ê²Œì‹œë¬¼ ì‚­ì œ</button>`;
                    }

                    list.innerHTML += `
                        <div class="card">
                            <div class="card-img-box">
                                <img src="${p.img}" class="card-img">
                                ${isSold ? '<div class="card-status">ë‚˜ëˆ”ì™„ë£Œ</div>' : ''}
                            </div>
                            <div class="card-info">
                                <div class="card-tag" style="color:var(--primary)">ë¬´ë£Œë‚˜ëˆ”</div>
                                <div class="card-title">${p.title}</div>
                                <div class="card-seller">ê¸°ë¶€ì: ${p.seller}</div>
                                <div class="card-actions">
                                    ${btnHtml}
                                    ${deleteBtn}
                                </div>
                            </div>
                        </div>`;
                });
            }
        };

        window.app.init();
    </script>
</body>
</html>